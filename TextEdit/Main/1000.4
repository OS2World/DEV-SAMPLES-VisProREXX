/* Event Drag start -   1000 */
Arg window self


value=get()

if pos('0D'x,value)=1 | pos('0D'x,value)=2 then 
  value=strip(value,'L','0d'x)

if pos('0a'x,value)=1 | pos('0a'x,value)=2 then
  value=strip(value,'L','0a'x)

rc=lineout(drive||drg_file, value)
rc=lineout(drive||drg_file)

/* Get selection range 1000 Multi-Line Entry Field */
range=VpGetIndex(window,1000)
PARSE VAR range first last

draginfo.0=1 /* count */
draginfo.1=1 /* moveable */
draginfo.2=1 /* copyable */
draginfo.3=1 /* linkable */
draginfo.4=drgico /* optional icon */
draginfo.1.1='Plain Text' /* type */
draginfo.1.2='<DRM_OS2FILE,DRF_TEXT>' /* rendering */
draginfo.1.3=drive    /* source dir */
draginfo.1.4=drg_file /* source */
draginfo.1.5=drg_file /* target */
CALL VpWindow window,'DRAGSTART','DRAGINFO.'

